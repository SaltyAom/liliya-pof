document.addEventListener("DOMContentLoaded",()=>{let e=e=>document.getElementById(e),t=(e,t,r)=>e.setAttribute(t,r),r=e("blog"),n=e("title"),l=e("header-image"),o=e("header-image-wrapper"),i=o.querySelector(".webp"),s=o.querySelector(".fallback"),c=e("next"),a=next.querySelector(".img"),d=a.previousElementSibling,p=d.previousElementSibling,u=next.querySelector(".h2"),h=e("previous"),g=previous.querySelector(".img"),m=g.previousElementSibling,f=m.previousElementSibling,v=previous.querySelector(".h2"),x=e("liliya-title"),w=e("prefetch-next"),b=e("prefetch-previous"),y=(e="2x",t)=>{let r=t.split(".");return r.splice(r.length-1,0,`@${e}.`),r.reduce((e,t)=>e+=t)},C=e=>E(e)+", "+y("2x",E(e))+" 2x",S=e=>y("preload",E(e))+", "+y("preload@2x",E(e))+" 2x",E=e=>e.replace(/ /g,"%20"),k=(e,t)=>{let r=e.split(".");return r.splice(r.length-1,0,"."),r.pop(),(r=r.reduce((e,t)=>e+=t))+t},q=e=>{let t=e.split(".");return"png"===t[t.length-1]?"image/png":"image/jpeg"};const L=r=>{let n,{nodeName:l}=r;switch(l){case"h1":case"h2":case"p":(n=document.createElement(l)).classList.add(l),"p"!==l?n.textContent=r.textContent:r.children.forEach(e=>n.appendChild("string"==typeof e?document.createTextNode(e):L(e)));break;case"a":(n=document.createElement("a")).classList.add("a"),t(n,"href",r.href||""),t(n,"rel","noreopener norefferer"),t(n,"target","_blank"),n.textContent=r.textContent;break;case"img":let o=e("liliya-image").cloneNode(!0).content,i=o.querySelector(".img");t(i,"src",r.src),t(i,"alt",r.alt);let s=o.querySelector(".webp"),c=o.querySelector(".fallback");t(s,"srcset",C(k(r.src,"webp"))),t(c,"srcset",C(r.src)),t(c,"type",q(r.src)),n=o}return n};async function N(e){navigator.serviceWorker&&null!==navigator.serviceWorker.controller&&e.preventDefault();let o=this.getAttribute("x-src"),{header:{title:y,src:E,alt:N},content:j,footer:{next:A,previous:W}}=await fetch(o).then(e=>e.json()),D=r.childElementCount-2;window.history.pushState({},y,this.href),requestAnimationFrame(()=>{for(n.textContent=y,t(l,"src",E),t(l,"alt",N),t(i,"srcset",C(k(E,"webp"))),t(s,"srcset",C(E)),t(s,"type",q(E)),j.forEach((e,n)=>{let l=r.children[n+1];if(n>D)return r.appendChild(L(e));if(l.nodeName.toLowerCase()===e.nodeName||"figure"===l.nodeName.toLowerCase()&&"img"===e.nodeName)switch(e.nodeName){case"h1":case"h2":return l.textContent=e.textContent;case"p":return r.replaceChild(L(e),l);case"figure":let n=l.querySelector(".img");return t(n,"src",e.src),void t(n,"alt",e.alt)}r.replaceChild(L(e),l)});r.children[j.length].nextElementSibling;)r.removeChild(r.children[j.length].nextSibling);t(c,"href",A.href),t(c,"x-src",A.json),t(h,"href",W.href),t(h,"x-src",W.json),t(a,"src",A.src),t(p,"srcset",S(k(A.src,"webp"))),t(d,"srcset",S(A.src)),t(d,"type",q(A.src)),t(a,"alt",A.alt),t(g,"src",W.src),t(f,"srcset",S(k(W.src,"webp"))),t(m,"srcset",S(W.src)),t(m,"type",q(W.src)),t(g,"alt",W.alt),u.textContent=A.title,v.textContent=W.title,x.textContent=y,t(w,"href",A.json),t(b,"href",W.json),requestAnimationFrame(()=>{window.scrollTo(0,0)})})}let j=()=>{navigator.serviceWorker&&navigator.serviceWorker.register("/service-worker.js"),window.removeEventListener("load",j)};e("previous").addEventListener("click",N),e("next").addEventListener("click",N),window.addEventListener("load",j)})